"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _table=_interopRequireDefault(require("../../table"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ownKeys(t,e){var r=Object.keys(t);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(t)),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r}function _objectSpread(t){for(var r=1;r<arguments.length;r++)if(r%2){var o=null!=arguments[r]?arguments[r]:{};ownKeys(o,!0).forEach(function(e){_defineProperty(t,e,o[e])})}else Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(arguments[r])):ownKeys(o).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(arguments[r],e))});return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var methods={},excelEditConfig={trigger:"dblclick",mode:"cell",showIcon:!1,showStatus:!1};Object.keys(_table.default.methods).forEach(function(e){methods[e]=function(){return this.$refs.xTable[e].apply(this.$refs.xTable[e],arguments)}});var excelContextMenu={header:{options:[[{code:"exportAll",name:"隐藏列"},{code:"exportAll",name:"取消所有隐藏"}]]},body:{options:[[{code:"clip",name:"剪贴(Ctrl+X)"},{code:"copy",name:"复制(Ctrl+C)"},{code:"paste",name:"粘贴(Ctrl+V)"}],[{code:"insert",name:"插入"},{code:"remove",name:"删除"},{code:"clearData",name:"清除内容(Del)"}],[{code:"sort",name:"排序",children:[{code:"clearSort",name:"清除排序"},{code:"sortAsc",name:"升序"},{code:"sortDesc",name:"倒序"}]}],[{code:"exportAll",name:"导出数据.csv"}]]}},_default={name:"SExcel",props:_objectSpread({columns:Array},_table.default.props),data:function(){return{excelStore:{uploadRows:[]}}},computed:{tableProps:function(){var e=this.$props,t=this.editConfig;return _objectSpread({},e,{border:!0,resizable:!0,showOverflow:null,contextMenu:excelContextMenu,mouseConfig:{selected:!0,checked:!0},keyboardConfig:{isArrow:!0,isDel:!0,isTab:!0,isCut:!0,isEdit:!0},editConfig:Object.assign({},excelEditConfig,t),optimization:{scrollX:{gt:100,oSize:6,rSize:20},scrollY:{gt:100,oSize:30,rSize:80}}})}},watch:{columns:function(e){this.loadColumn(e)}},mounted:function(){var e=this.columns;e&&e.length&&this.loadColumn(this.columns)},render:function(e){var t=this.$slots,r=this.$listeners;return e("s-table",{class:"s-excel",props:this.tableProps,on:_objectSpread({},r,{"context-menu-click":this.contextMenuClickEvent}),ref:"xTable"},t.default)},methods:_objectSpread({},methods,{contextMenuClickEvent:function(e,t){var r=e.menu,o=e.row,n=e.column,c=this.$refs.xTable,a=n.property;switch(r.code){case"clip":c.handleCopyed(!0,t);break;case"copy":c.handleCopyed(!1,t);break;case"paste":c.handlePaste(t);break;case"insert":c.insertAt({},o);break;case"remove":c.remove(o);break;case"clearData":c.clearData(o,a);break;case"clearFilter":c.clearFilter();break;case"clearSort":c.clearSort();break;case"sortAsc":c.sort(a,"asc");break;case"sortDesc":c.sort(a,"desc");break;case"exportAll":c.exportCsv({isHeader:!1})}}})};exports.default=_default;