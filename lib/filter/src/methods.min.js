"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils/methods/xe-utils")),_conf=_interopRequireDefault(require("../../conf")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default={filter:function(e,t){var l=this.getColumnByField(e),i=l.filters;if(t){var o=t(i);_xeUtils.default.isArray(o)&&(l.filters=_tools.UtilTools.getFilters(o))}return Promise.resolve(i)},triggerFilterEvent:function(e,t,l){var i=this.$refs,o=this.filterStore,r=this.$el;if(o.column===t&&o.visible)o.visible=!1;else{var s=e.target,n=i.filterWrapper,a=_tools.DomTools.getAbsolutePos(s),c=a.top,u=a.left;if(0<_tools.DomTools.getParents(r,".s-table-complete-outline").length){var f=_tools.DomTools.getOffsetPos(s,_tools.DomTools.getParents(r,".s-table-complete-outline")[0].children[0]),h=f.top,p=f.left;c=h,u=p}Object.assign(o,{args:l,multiple:t.filterMultiple,options:t.filters,column:t,style:{zIndex:_conf.default.tooltip.zIndex,top:"".concat(c+s.clientHeight+6,"px"),left:"".concat(u,"px")},visible:!0}),o.isAllSelected=o.options.every(function(e){return e.checked}),o.isIndeterminate=!o.isAllSelected&&o.options.some(function(e){return e.checked}),this.$nextTick(function(){var e=n.$el;o.style.top="".concat(c+s.clientHeight+6,"px"),o.style.left="".concat(u-e.clientWidth/2+10,"px")})}},confirmFilterEvent:function(e){var t=this.visibleColumn,l=this.filterStore,i=this.remoteFilter,o=this.scrollXLoad,r=this.scrollYLoad,s=l.column,n=s.property,a=[],c=[];s.filters.forEach(function(e){e.checked&&(a.push(e.value),c.push(e.data))}),l.visible=!1,i||this.handleTableData(!0);var u=[];t.filter(function(e){var t=e.property,l=e.filters,i=[],o=[];l&&l.length&&(l.forEach(function(e){e.checked&&(i.push(e.value),o.push(e.data))}),u.push({column:e,property:t,field:t,prop:t,values:i,datas:o}))}),_tools.UtilTools.emitEvent(this,"filter-change",[{column:s,property:n,field:n,prop:n,values:a,datas:c,filters:u,$table:this}]),this.updateFooter(),(o||r)&&(this.clearScroll(),r&&this.updateScrollYSpace()),this.closeFilter(),this.$nextTick(this.recalculate)},resetFilterEvent:function(e){this.filterStore.options.forEach(function(e){e.checked=!1,e.data=e._data}),this.confirmFilterEvent(e)},clearFilter:function(e){var t=arguments.length?this.getColumnByField(e):null,l=this.filterStore,i=function(e){var t=e.filters;t&&t.length&&t.forEach(function(e){e.checked=!1,e.data=e._data})};return t?i(t):this.visibleColumn.forEach(i),t&&t===l.column||Object.assign(l,{isAllSelected:!1,isIndeterminate:!1,style:null,options:[],column:null,multiple:!1,visible:!1}),this.updateData()}};exports.default=_default;