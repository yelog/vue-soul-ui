"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.DomTools=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils")),_utils=_interopRequireDefault(require("./utils"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var browse=_xeUtils.default.browse(),htmlElem=document.querySelector("html"),bodyElem=document.body;function rClass(e){return rClsMap[e]||(rClsMap[e]=new RegExp("(?:^|\\s)".concat(e,"(?!\\S)"),"g")),rClsMap[e]}var rClsMap={},DomTools={browse:browse,isPx:function(e){return e&&/^\d+(px)?$/.test(e)},isScale:function(e){return e&&/^\d+%$/.test(e)},hasClass:function(e,t){return e&&e.className&&e.className.match&&e.className.match(rClass(t))},removeClass:function(e,t){e&&DomTools.hasClass(e,t)&&(e.className=e.className.replace(rClass(t),""))},addClass:function(e,t){e&&!DomTools.hasClass(e,t)&&(DomTools.removeClass(e,t),e.className="".concat(e.className," ").concat(t))},updateCellTitle:function(e){var t=e.currentTarget.querySelector(".s-cell"),o=t.innerText;t.getAttribute("title")!==o&&t.setAttribute("title",o)},rowToVisible:function(e,t){var o=e.$refs.tableBody.$el,l=o.querySelector('[data-rowid="'.concat(_utils.default.getRowid(e,t),'"]'));if(l){var r=o.clientHeight,s=o.scrollTop,n=l.offsetTop+(l.offsetParent?l.offsetParent.offsetTop:0),a=l.clientHeight;n<s||s+r<n?o.scrollTop=n:r+s<=n+a&&(o.scrollTop=s+a)}else e.scrollYLoad&&(o.scrollTop=(e.afterFullData.indexOf(t)-1)*e.scrollYStore.rowHeight)},colToVisible:function(e,t){var o=e.$refs.tableBody.$el,l=o.querySelector(".".concat(t.id));if(l){var r=o.clientWidth,s=o.scrollLeft,n=l.offsetLeft+(l.offsetParent?l.offsetParent.offsetLeft:0),a=l.clientWidth;n<s||s+r<n?o.scrollLeft=n:r+s<=n+a&&(o.scrollLeft=s+a)}else if(e.scrollXLoad){for(var f=e.visibleColumn,i=0,c=0;c<f.length&&f[c]!==t;c++)i+=f[c].renderWidth;o.scrollLeft=i}},getDomNode:function(){var e=document.documentElement,t=document.body;return{scrollTop:e.scrollTop||t.scrollTop,scrollLeft:e.scrollLeft||t.scrollLeft,visibleHeight:e.clientHeight||t.clientHeight,visibleWidth:e.clientWidth||t.clientWidth}},getEventTargetNode:function(e,t,o){for(var l,r=e.target;r&&r.nodeType&&r!==document;){if(o&&DomTools.hasClass(r,o))l=r;else if(r===t)return{flag:!o||!!l,container:t,targetElem:l};r=r.parentNode}return{flag:!1}},getOffsetPos:function(e,t){return getNodeOffset(e,t,{left:0,top:0})},getAbsolutePos:function(e){var t=e.getBoundingClientRect(),o=DomTools.getDomNode(),l=o.scrollTop,r=o.scrollLeft;return{top:l+t.top,left:r+t.left}},getCellNodeIndex:function(e){var t=e.parentNode;return{columnIndex:_xeUtils.default.arrayIndexOf(t.children,e),rowIndex:_xeUtils.default.arrayIndexOf(t.parentNode.children,t)}},getRowNodes:function(e,t,o){for(var l=t.columnIndex,r=t.rowIndex,s=o.columnIndex,n=o.rowIndex,a=[],f=Math.min(r,n),i=Math.max(r,n);f<=i;f++){for(var c=[],d=e[f],u=Math.min(l,s),m=Math.max(l,s);u<=m;u++){var p=d.children[u];c.push(p)}a.push(c)}return a},getCellIndexs:function(e){var t=e.parentNode,o=t.getAttribute("data-rowid"),l=[].indexOf.call(t.children,e);return{rowid:o,rowIndex:[].indexOf.call(t.parentNode.children,t),columnIndex:l}},getCell:function(e,t){var o=t.row,l=t.column,r=_utils.default.getRowid(e,o);return e.$refs.tableBody.$el.querySelector('.s-body--row[data-rowid="'.concat(r,'"] .').concat(l.id))}};function getNodeOffset(e,t,o){if(e){var l=e.parentNode;if(o.top+=e.offsetTop,o.left+=e.offsetLeft,l&&l!==htmlElem&&l!==bodyElem&&(o.top-=l.scrollTop,o.left-=l.scrollLeft),(!t||e!==t&&e.offsetParent!==t)&&e.offsetParent)return getNodeOffset(e.offsetParent,t,o)}return o}var _default=exports.DomTools=DomTools;exports.default=_default;