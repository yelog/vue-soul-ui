"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils/methods/xe-utils")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,l,o){return l in e?Object.defineProperty(e,l,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[l]=o,e}var _default={name:"STableFooter",props:{footerData:Array,tableColumn:Array,visibleColumn:Array,fixedColumn:Array,size:String,fixedType:String},mounted:function(){var e=this.$parent,l=this.$el,o=this.$refs,t=this.fixedType,r=e.elemStore,n="".concat(t||"main","-footer-");r["".concat(n,"wrapper")]=l,r["".concat(n,"table")]=o.table,r["".concat(n,"colgroup")]=o.colgroup,r["".concat(n,"list")]=o.tfoot,r["".concat(n,"x-space")]=o.xSpace},render:function(C){var e=this._e,S=this.$parent,U=this.fixedType,l=this.fixedColumn,o=this.tableColumn,k=this.footerData,E=S.$listeners,t=S.footerRowClassName,L=S.footerCellClassName,r=S.footerRowStyle,P=S.footerCellStyle,A=S.footerAlign,D=S.footerSpanMethod,F=S.align,n=S.scrollXLoad,O=S.columnKey,X=S.showOverflow,q=S.overflowX,N=S.getColumnIndex;return U&&X?o=l:n&&U&&(o=l),C("div",{class:["s-table--footer-wrapper",U?"fixed-".concat(U,"--wrapper"):"body--wrapper"],on:{scroll:this.scrollEvent}},[U?e():C("div",{class:"s-body--x-space",ref:"xSpace"}),C("table",{class:"s-table--footer",attrs:{cellspacing:0,cellpadding:0,border:0},ref:"table"},[C("colgroup",{ref:"colgroup"},o.map(function(e,l){return C("col",{attrs:{name:e.id},key:l})}).concat([C("col",{attrs:{name:"col_gutter"}})])),C("tfoot",{ref:"tfoot"},k.map(function(I,T){return C("tr",{class:["s-footer--row",t?_xeUtils.default.isFunction(t)?t({$table:S,$rowIndex:T,fixed:U}):t:""],style:r?_xeUtils.default.isFunction(r)?r({$table:S,$rowIndex:T,fixed:U}):r:null},o.map(function(l,o){var e,t=l.showOverflow,r=l.footerAlign,n=l.align,i=l.footerClassName,a=l.children&&l.children.length,c=U?l.fixed!==U&&!a:l.fixed&&q,s=_xeUtils.default.isUndefined(t)||_xeUtils.default.isNull(t)?X:t,d=r||n||A||F,u="title"===s,f="tooltip"===s,x=!0===s||"complete"===s,p=x||u||f||"ellipsis"===s,m={"data-colid":l.id},$={},b=N(l),v={$table:S,$rowIndex:T,column:l,columnIndex:b,$columnIndex:o,fixed:U};if((u||f||x)&&($.mouseenter=function(e){u?_tools.DomTools.updateCellTitle(e):x?S.triggerCompleteEvent(e,{$table:S,$rowIndex:T,column:l,columnIndex:b,$columnIndex:o,locationType:"footer",fixed:U}):f&&S.triggerFooterTooltipEvent(e,{$table:S,$rowIndex:T,column:l,columnIndex:b,$columnIndex:o,fixed:U})}),(f||x)&&($.mouseleave=function(e){x?S.closeComplete(e):f&&S.handleTargetLeaveEvent(e)}),E["header-cell-click"]&&($.click=function(e){_tools.UtilTools.emitEvent(S,"header-cell-click",[{$table:S,$rowIndex:T,column:l,columnIndex:b,$columnIndex:o,fixed:U,cell:e.currentTarget},e])}),E["header-cell-dblclick"]&&($.dblclick=function(e){_tools.UtilTools.emitEvent(S,"header-cell-dblclick",[{$table:S,$rowIndex:T,column:l,columnIndex:b,$columnIndex:o,fixed:U,cell:e.currentTarget},e])}),D){var _=D({$table:S,$rowIndex:T,column:l,columnIndex:b,$columnIndex:o,fixed:U,data:k})||{},g=_.rowspan,h=void 0===g?1:g,y=_.colspan,w=void 0===y?1:y;if(!h||!w)return null;m.rowspan=h,m.colspan=w}return C("td",{class:["s-footer--column",l.id,(e={},_defineProperty(e,"col--".concat(d),d),_defineProperty(e,"fixed--hidden",c),_defineProperty(e,"col--ellipsis",p),_defineProperty(e,"filter--active",l.filters.some(function(e){return e.checked})),e),_tools.UtilTools.getClass(i,v),_tools.UtilTools.getClass(L,v)],attrs:m,style:P?_xeUtils.default.isFunction(P)?P({$table:S,$rowIndex:T,column:l,columnIndex:b,$columnIndex:o,fixed:U}):P:null,on:$,key:O?l.id:b},[C("div",{class:"s-cell"},_tools.UtilTools.formatText(I[S.tableColumn.indexOf(l)],1))])}).concat([C("td",{class:"col--gutter"})]))}))])])},methods:{scrollEvent:function(e){var l=this.$parent,o=this.fixedType,t=l.$refs,r=l.scrollXLoad,n=l.triggerScrollXEvent,i=l.lastScrollLeft,a=t.tableHeader,c=a?a.$el:null,s=t.tableBody.$el,d=t.tableFooter.$el.scrollLeft,u=d!==i;l.lastScrollLeft=d,l.lastScrollTime=Date.now(),c&&(c.scrollLeft=d),s&&(s.scrollLeft=d),r&&u&&n(e),_tools.UtilTools.emitEvent(l,"scroll",[{type:"footer",fixed:o,scrollTop:s.scrollTop,scrollLeft:d,isX:u,isY:!1,$table:l},e])}}};exports.default=_default;